<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pausa para Sentir</title>
</head>
<body>
  <main>
    <blockquote id="frase-texto"></blockquote>
    <footer id="frase-autor"></footer>
    <button id="btn-nova-frase">Nova frase</button>
    <button id="btn-favoritar">Favoritar</button>
    <button id="btn-voz">Ouvir</button>
    <button id="btn-lista-favoritos">Ver Favoritos</button>
    <div>
      <a id="share-whatsapp" target="_blank">WhatsApp</a>
      <a id="share-twitter" target="_blank">Twitter</a>
      <a id="share-facebook" target="_blank">Facebook</a>
      <a id="share-threads" target="_blank">Threads</a>
      <a id="share-instagram" target="_blank">Instagram</a>
    </div>
    <section id="favoritos-container" hidden>
      <ul id="lista-favoritos"></ul>
    </section>
  </main>

<script>
const frases = [
  { id: "frase1", texto: "A felicidade se basta.", autor: "Rubem Alves" },
  { id: "frase2", texto: "Você precisa escutar o que você tem a dizer.", autor: "Desconhecido" },
  { id: "frase3", texto: "Mais do que autoconhecer-se, desconheça-se.", autor: "Tamires Henke" }
];

const fraseTextoEl = document.getElementById('frase-texto');
const fraseAutorEl = document.getElementById('frase-autor');
const btnNovaFrase = document.getElementById('btn-nova-frase');
const btnFavoritar = document.getElementById('btn-favoritar');
const btnVoz = document.getElementById('btn-voz');
const btnListaFavoritos = document.getElementById('btn-lista-favoritos');
const favoritosContainer = document.getElementById('favoritos-container');
const listaFavoritos = document.getElementById('lista-favoritos');

let indiceAtual = 0;
let favoritos = new Set(JSON.parse(localStorage.getItem('favoritosPausaParaSentir') || '[]'));

function mostrarFrase(indice) {
  const f = frases[indice];
  fraseTextoEl.textContent = f.texto;
  fraseAutorEl.textContent = f.autor === 'Desconhecido' ? '— Autor desconhecido' : '— ' + f.autor;
  indiceAtual = indice;
  atualizarLinksCompartilhar();
}

function novaFrase() {
  let novoIndice;
  do {
    novoIndice = Math.floor(Math.random() * frases.length);
  } while (novoIndice === indiceAtual);
  mostrarFrase(novoIndice);
}

function toggleFavorito() {
  const id = frases[indiceAtual].id;
  favoritos.has(id) ? favoritos.delete(id) : favoritos.add(id);
  localStorage.setItem('favoritosPausaParaSentir', JSON.stringify([...favoritos]));
}

function mostrarFavoritos() {
  listaFavoritos.innerHTML = '';
  if (favoritos.size === 0) {
    listaFavoritos.innerHTML = '<li>Nenhuma frase favoritada ainda.</li>';
  } else {
    [...favoritos].forEach(favId => {
      const f = frases.find(fr => fr.id === favId);
      if (f) {
        const li = document.createElement('li');
        li.textContent = `${f.texto} — ${f.autor === 'Desconhecido' ? 'Autor desconhecido' : f.autor}`;
        listaFavoritos.appendChild(li);
      }
    });
  }
  favoritosContainer.hidden = false;
}

function falarFrase() {
  const frase = frases[indiceAtual].texto + ' — ' + frases[indiceAtual].autor;
  const utter = new SpeechSynthesisUtterance(frase);
  const vozFem = window.speechSynthesis.getVoices().find(v => v.lang.startsWith('pt') && v.name.toLowerCase().includes('female')) || null;
  if (vozFem) utter.voice = vozFem;
  window.speechSynthesis.speak(utter);
}

function atualizarLinksCompartilhar() {
  const f = frases[indiceAtual];
  const texto = `${f.texto} — ${f.autor === 'Desconhecido' ? 'Autor desconhecido' : f.autor}`;
  const link = encodeURIComponent(`${texto}\n${window.location.href}`);

  document.getElementById('share-whatsapp').href = `https://wa.me/?text=${link}`;
  document.getElementById('share-twitter').href = `https://twitter.com/intent/tweet?text=${link}`;
  document.getElementById('share-facebook').href = `https://www.facebook.com/sharer/sharer.php?u=${window.location.href}&quote=${link}`;
  document.getElementById('share-threads').href = `https://www.threads.net/intent/post?text=${link}`;
  document.getElementById('share-instagram').addEventListener('click', e => {
    e.preventDefault();
    navigator.clipboard.writeText(texto).then(() => {
      alert('Texto copiado! Agora cole no Instagram (Stories ou Direct).');
      window.open('https://www.instagram.com/', '_blank');
    });
  });
}

btnNovaFrase.onclick = novaFrase;
btnFavoritar.onclick = toggleFavorito;
btnVoz.onclick = falarFrase;
btnListaFavoritos.onclick = mostrarFavoritos;

window.onload = () => mostrarFrase(0);
</script>
</body>
</html>
